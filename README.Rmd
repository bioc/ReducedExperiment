---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r setup, include = FALSE}
knitr::opts_chunk$set(
    collapse = TRUE,
    comment = "#>",
    fig.path = "man/figures/README-",
    out.width = "100%"
)
```

# ReducedExperiment 
<!-- <img src="inst/ReducedExperiment_hex.png" align="right" height="174" width="150" /> -->

<!-- badges: start -->
[![R-CMD-check](https://github.com/jackgisby/ReducedExperiment/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/jackgisby/ReducedExperiment/actions/workflows/R-CMD-check.yaml)
<!-- [![check-bioc](https://github.com/jackgisby/ReducedExperiment/actions/workflows/check-bioc.yml/badge.svg)](https://github.com/jackgisby/ReducedExperiment/actions/workflows/check-bioc.yml) -->
[![codecov](https://codecov.io/gh/jackgisby/ReducedExperiment/graph/badge.svg?token=FHNH7AA6S3)](https://codecov.io/gh/jackgisby/ReducedExperiment)
[![GitHub issues](https://img.shields.io/github/issues/jackgisby/ReducedExperiment)](https://github.com/jackgisby/ReducedExperiment/issues)
[![GitHub pulls](https://img.shields.io/github/issues-pr/jackgisby/ReducedExperiment)](https://github.com/jackgisby/ReducedExperiment/pulls)
[![Lifecycle: experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://lifecycle.r-lib.org/articles/stages.html#experimental)
<!-- [![Bioc release status](http://www.bioconductor.org/shields/build/release/bioc/ReducedExperiment.svg)](https://bioconductor.org/checkResults/release/bioc-LATEST/ReducedExperiment) -->
<!-- [![Bioc devel status](http://www.bioconductor.org/shields/build/devel/bioc/ReducedExperiment.svg)](https://bioconductor.org/checkResults/devel/bioc-LATEST/ReducedExperiment) -->
<!-- [![Bioc downloads rank](https://bioconductor.org/shields/downloads/release/ReducedExperiment.svg)](http://bioconductor.org/packages/stats/bioc/ReducedExperiment/) -->
<!-- [![Bioc support](https://bioconductor.org/shields/posts/ReducedExperiment.svg)](https://support.bioconductor.org/tag/ReducedExperiment) -->
<!-- [![Bioc history](https://bioconductor.org/shields/years-in-bioc/ReducedExperiment.svg)](https://bioconductor.org/packages/release/bioc/html/ReducedExperiment.html#since) -->
<!-- [![Bioc last commit](https://bioconductor.org/shields/lastcommit/devel/bioc/ReducedExperiment.svg)](http://bioconductor.org/checkResults/devel/bioc-LATEST/ReducedExperiment/) -->
<!-- [![Bioc dependencies](https://bioconductor.org/shields/dependencies/release/ReducedExperiment.svg)](https://bioconductor.org/packages/release/bioc/html/ReducedExperiment.html#since) -->

<!-- badges: end -->

ReducedExperiment provides SummarizedExperiment-like containers for storing and
manipulating dimensionally-reduced assay data. The ReducedExperiment
classes allow users to simultaneously manipulate their original dataset
and their decomposed data, in addition to other method-specific outputs
like feature loadings. Implements utilities and specialised classes for the 
application of stabilised independent component analysis (sICA) and 
weighted gene correlation network analysis (WGCNA).

## Installation

Get the latest stable `R` release from [CRAN](http://cran.r-project.org/). Then install `ReducedExperiment` from [Bioconductor](http://bioconductor.org/) using the following code:

```{r 'install', eval = FALSE}
if (!requireNamespace("BiocManager", quietly = TRUE)) {
    install.packages("BiocManager")
}

BiocManager::install("ReducedExperiment")
```

And the development version from [GitHub](https://github.com/jackgisby/ReducedExperiment) with:

```{r 'install_dev', eval = FALSE}
devtools::install_github("jackgisby/ReducedExperiment")
```

## Usage

`ReducedExperiment` objects are derived from `SummarizedExperiment` objects, with
additional slots designed to store and manipulate the outputs of common
dimensionality reduction techniques. 

As an example, the `SummarizedExperiment` described below contains gene 
expression data from individuals with COVID-19. It contains the following slots:
- `assays` - A features by samples matrix containing the expression data.
- `colData` - Contains a row for each sample containing phenotype data.
- `rowData` - Contains a row for each feature containing gene IDs.

The `SummarizedExperiment` objects are convenient
because, when we slice the rows or columns of the expression matrix, the 
metadata for the rows and columns are sliced accordingly.

```{r load_se, eval=requireNamespace('SummarizedExperiment'), include=FALSE}
library(SummarizedExperiment)

se <- readRDS(system.file("extdata", "wave1.rds",
    package = "ReducedExperiment"
))

assay(se, "normal") <- assay(se, "cpm")
assay(se, "cpm") <- NULL
```

```{r show_se, eval=requireNamespace('SummarizedExperiment'), message=FALSE, warning=FALSE}
library("SummarizedExperiment")

se
```

The `SummarizedExperiment` has two dimensions, representing the features (2,184)
and samples (234). 

We can perform a factor analysis on these data, the result of which is a set
of reduced components and feature loadings. 

```{r estimate_factors, eval=requireNamespace('SummarizedExperiment'), message=FALSE, warning=FALSE}
library("ReducedExperiment")

fe <- estimate_factors(se, nc = 35)

fe
```

This `FactorisedExperiment` object has an additional dimension representing the 
35 factors. It also has additional slots, including:
- `reduced` - A samples by factors matrix containing the dimensionally-reduced 
    data.
- `loadings` - Contains a features by factors matrix containing the loadings.

The `ReducedExperiment` objects allow users to simultaneously slice and modify the 
`assays`, `rowData`, `colData`, `reduced` and `loadings` matrices. Here, we 
provided a `SummarizedExperiment` object to `estimate_factors`, but we could 
just have easily provided a simple expression matrix.

## Functionality

The package currently provides three types of container:
- `ReducedExperiment` - A basic container that can store dimensionally-reduced 
    components.
- `FactorisedExperiment` - A container based on `ReducedExperiment` designed for
    working with the results of factor analysis. It can contain feature loadings
    and factor stability values.
- `ModularExperiment` - A container based on `ReducedExperiment` designed for
    working with modules of features (usually genes), as is produced by the
    popular Weighted Gene Correlation Network Analysis (WGCNA) approach. It
    contains the mapping of features to modules

Various tools are provided by the package for applying dimensionality reduction
and manipulating their results. These include:
- Workflows for applying independent component analysis (ICA) and 
    WGCNA. We additionally developed an R implementation of the stabilised ICA 
    algorithm.
- Methods for applying pathway enrichment analysis to factors and modules.
- Functions for identifying associations between factors/modules and 
    sample-level variables.
- Methods for applying identified factors or modules to new datasets.
- Other approach-specific plots and utilities, such as factor stability plots
    and module preservation plots.

Many of these are demonstrated in more detail in the [package's vignette](https://jackgisby.github.io/ReducedExperiment/articles/ReducedExperiment.html).

The containers implemented in `ReducedExperiment` are designed to be extensible. 
We encourage the development of children classes with additional, or 
alternative, slots and methods.

## Citation

Below is the citation output from using `citation('ReducedExperiment')` in R. 

```{r 'citation', eval = requireNamespace('ReducedExperiment')}
print(citation("ReducedExperiment"), bibtex = TRUE)
```

The `ReducedExperiment` package relies on many software packages and development
tools. The packages used are listed in the vignette and relevant papers are 
cited.
